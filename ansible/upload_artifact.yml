- hosts: all
  remote_user: steven
  become: true
  become_user: root
  tasks:
  - name: Include global variables
    include_vars:
      file: variables.yml
      name: config
  - name: Clean artifact path
    file:
      state: absent
      path: "{{config.GOPATH}}"
    when: reset_network == 'true'
  - name: ansible create a directory for go application
    file:
      path: "{{config.GOPATH}}"
      state: directory
      mode: 0777
    when: reset_network == 'true'
  - name: copy binary executables to remote servers
    copy:
      src: ../{{item}}
      dest: /usr/local/bin
      mode: 0777
    with_items:
      ["bin/olfullnode","bin/olconfig","bin/olmonitor", "bin/olvm", "bin/olclient"]
  - set_fact: app_directory={{config.GOPATH}}